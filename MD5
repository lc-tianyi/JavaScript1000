const crypto = require('crypto')
// æ¢¯åº¦ 0  ï¼ˆMD5 è£¸ç®—ï¼Œ10 é¢˜ï¼‰
// 1. è®¡ç®—å­—ç¬¦ä¸² `"abc"` çš„ MD5 åå…­è¿›åˆ¶ã€‚
function abc(){
    return crypto.createHash('md5').update('abc').digest('hex')
}
console.log(abc())
// 2. è®¡ç®— `"abc"` + `"123"` æ‹¼æ¥åçš„ MD5ã€‚
function abc(){
    return crypto.createHash('md5').update('abc' + String(123)).digest('hex')
}
console.log(abc())
// 3. æŠŠå½“å‰æ—¶é—´æˆ³ï¼ˆç§’ï¼‰è½¬å­—ç¬¦ä¸²åç®— MD5 å¹¶æ‰“å°ã€‚
function shi_jian(){
    const shi = new Date('2025-11-10T22:27').getTime()
    return crypto.createHash('md5').update(String(shi)).digest('hex')
}
console.log(shi_jian())
// 4. å†™ä¸€ä¸ªå‡½æ•° `md5_hex(str)` è¿”å›å°å†™ 32 ä½ã€‚
function md5_hex(str){
    return crypto.createHash('md5').update(str).digest('hex')
}
console.log(md5_hex('123456'))
// 5. å†™ä¸€ä¸ªå‡½æ•° `md5_upper(str)` è¿”å›å¤§å†™ 32 ä½ã€‚
function md5_str(str){
    return crypto.createHash('md5').update(str).digest('hex').toUpperCase()
}
console.log(md5_str('123456'))
// 6. å†™ä¸€ä¸ªå‡½æ•° `md5_twice(str)` åšåŒé‡ MD5ã€‚
function md5_twice(str){
    const md5_twices = crypto.createHash('md5').update(str).digest('hex')
    return crypto.createHash('md5').update(md5_twices).digest('hex')
}
console.log(md5_twice('24264564321'))
// 7. å†™ä¸€ä¸ªå‡½æ•° `md5_slice(str)` å–ä¸­é—´ 16 ä½ï¼ˆ8-24ï¼‰ã€‚
function md5_slice(str){
    // ç´¢å¼•ï¼šslice()
    return crypto.createHash('md5').update(str).digest('hex').slice(8,24)
}
console.log(md5_slice('1231324654'))
// 8. å†™ä¸€ä¸ªå‡½æ•° `md5_reverse(str)` æŠŠ 32 ä½ç»“æœåè½¬å†è¾“å‡ºã€‚
function md5_reverse(str){
    return crypto.createHash('md5').update(str).digest('hex').split('').reverse().join('')
}
console.log(md5_reverse('12234564654'))
// 9. å†™ä¸€ä¸ªå‡½æ•° `md5_salted(str, salt)` å…ˆæ‹¼ç›å†ç®—ã€‚
function md5_salted(str, salt){
    const ase = str + salt
    return crypto.createHash('md5').update(ase).digest('hex')
}
console.log(md5_salted('dfdfgdf','644654123'))
// 10. å†™ä¸€ä¸ªå‡½æ•° `md5_chunk(str, size=8)` æŠŠç»“æœæ¯ size å­—ç¬¦ç”¨ `-` è¿æ¥ã€‚
function md5_chunk(str,size=8){
    const hade =  crypto.createHash('md5').update(str).digest('hex');
    const hex = [];
    for (let i = 0; i < hade.length; i += size){
        hex.push(hade.slice(i, i + size));
    }
    return hex.join('-');
}
console.log(md5_chunk('5451dsf1sdfs2121'))

// ğŸŸ¢ æ¢¯åº¦ 1  ï¼ˆMD5+å­—å…¸åºç­¾åï¼Œ10 é¢˜ï¼‰
// 11. ç»™å®šå¯¹è±¡ `{a:1,b:2}` æŒ‰ key æ’åºåæ‹¼æˆ `"a1b2"` å†ç®— MD5ã€‚
function md5_key(){
    data = {a: 1, b: 2};
    let s = '';
    // ç”¨æšä¸¾æ³•æŒ‰ç…§é¡ºåºæŠŠæ•°æ®æŠ½å‡ºæ¥åšæ’åºï¼Œåœ¨ç”¨keyå’Œå€¼æ‹¼æ¥ã€‚
    for (const k of Object.keys(data).sort()) s += k + data[k];
    return crypto.createHash('md5').update(s).digest('hex')
}
console.log(md5_key())
// 12. æŠŠé¢˜ç›®11çš„ç»“æœå°è£…æˆå‡½æ•° `sign_basic(obj)`ã€‚
function sign_basic(obj) {
    let s = '';
    for (const k of Object.keys(obj).sort()) s += k + obj[k];
    return crypto.createHash('md5').update(s).digest('hex')
}
console.log(sign_basic({a: 1, b: 2}))
// // // 13. æŠŠ `{c:3,a:1,b:2}` åŒæ ·å¤„ç†ï¼ŒéªŒè¯é¡ºåºæ˜¯å¦ä¸€è‡´ã€‚
 function sign_basic(obj){
     let s = '';
     for (const k of Object.keys(obj).sort()) s += k + obj[k];
     return crypto.createHash('md5').update(s).digest('hex')
}
console.log(sign_basic({c:3,a:1,b:2}))
// 14. æŠŠ `{z:26,y:25,x:24}` å¤„ç†å¹¶æ‰“å° MD5ã€‚
function sign_basic(obj){
    let s = '';
    for (const k of Object.keys(obj).sort()) s += k + obj[k];
    return crypto.createHash('md5').update(s).digest('hex')
}
console.log(sign_basic({z:26,y:25,x:24}))
// 15. æŠŠ `{k:{},t:1}` ä¸­å¯¹è±¡è½¬ JSON å­—ç¬¦ä¸²åå‚ä¸æ‹¼æ¥å† MD5ã€‚
function sign_json(obj){
    let s = '';
    for (const k of Object.keys(obj).sort()) s += k + JSON.stringify(obj[k])
    return crypto.createHash('md5').update(s).digest('hex')
}
console.log(sign_json({k:{},t:1}))
// 16. æŠŠ `{list:[1,2,3],name:"abc"}` ä¸­æ•°ç»„è½¬ JSON åæ‹¼æ¥å† MD5ã€‚
function sign_json(obj){
    let s = '';
    for (const k of Object.keys(obj).sort()) s += k + JSON.stringify(obj[k])
    return crypto.createHash('md5').update(s).digest('hex')
}
console.log(sign_json({list:[1,2,3],name:"abc"}))
// 17. å†™ä¸€ä¸ªé€šç”¨å‡½æ•° `sign_json(obj, salt)` ç›æ”¾æœ€å‰å†æ‹¼æ¥ã€‚
function sign_json(obj,salt){
    s = String(salt)
    for (const k of Object.keys(obj).sort()) s += k + JSON.stringify(obj[k])
    return crypto.createHash('md5').update(s).digest('hex')
}
console.log(sign_json({list:[1,2,3],name:"abc"},'1546'))
// 18. æŠŠå½“å‰æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰ä½œä¸ºå­—æ®µ `ts` æ”¾å…¥å¯¹è±¡å†ç­¾åã€‚
function sign_json(obj,salt){
    s = String(salt)
    for (const k of Object.keys(obj).sort()) s += k + JSON.stringify(obj[k])
    return crypto.createHash('md5').update(s).digest('hex')
}
const data = { list: [1, 2, 3], name: 'abc', ts: Date.now() };
console.log(sign_json(data,'2025-01-01T00:00'))
// 19. æŠŠé¢˜ 18 å°è£…æˆ `sign_with_ts(obj, salt)` å¹¶è¿”å› `{obj, sign}`ã€‚
function sign_with_ts(obj,salt){
    s = String(salt)
    for (const k of Object.keys(obj).sort()) s += k + JSON.stringify(obj[k])
    const sign_1 = crypto.createHash('md5').update(s).digest('hex')
    return {obj,sign_1}
}
const data = { list: [1, 2, 3], name: 'abc', ts: Date.now() };
console.log(sign_with_ts(data,'2025-01-01T00:00'))
// 20. æŠŠé¢˜ 19 ç»“æœé€šè¿‡ `fetch` POST åˆ° `http://httpbin.org/post` çœ‹å›æ˜¾ã€‚
function sign_with_ts(obj,salt){
    s = String(salt)
    for (const k of Object.keys(obj).sort()) s += k + JSON.stringify(obj[k])
    const sign_1 = crypto.createHash('md5').update(s).digest('hex')
    return {obj,sign_1}
}
const data = { list: [1, 2, 3], name: 'abc', ts: Date.now() };
const body = sign_with_ts(data,'2025-01-01T00:00')
const url = 'http://httpbin.org/post'
fetch(url,{
    method:'post',
    headers: {
        'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36',
        body: JSON.stringify(body)
    }
})
.then(res => res.json())
.then(json => console.log('æœåŠ¡å™¨å›æ˜¾:\n', json.data))
.catch(err => console.error('è¯·æ±‚å¤±è´¥:', err.message));
